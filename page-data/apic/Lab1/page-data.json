{
    "componentChunkName": "component---src-pages-apic-lab-1-index-md",
    "path": "/apic/Lab1/",
    "result": {"pageContext":{"frontmatter":{"title":"Create and Secure an API to Proxy an Existing REST Web Service"},"relativePagePath":"/apic/Lab1/index.md","titleType":"page","MdxNode":{"id":"9ac008a1-c2cd-5135-ad5d-970eb0383d51","children":[],"parent":"09944ff2-a1dc-5b3a-a9de-2e3ff180cc83","internal":{"content":"---\ntitle: Create and Secure an API to Proxy an Existing REST Web Service\n---\n\n### [Return to main APIC lab page](../../APIC-labs-new/Overview/)\n\n---\n\n# Table of Contents\n1. [Introduction](#introduction)\n2. [Deploying the REST Service](#deploy)\n\n3. [Import an API into the Developer Workspace](#import_api)\n\n4. [Configure the API ](#configure_api)  \n   1. [Configure API Key Security](#configure_security)  \n   2. [Define a Target-URL for Sandbox Environment](#target_url)  \n   3. [Configure Proxy Call in Designer](#proxy)  \n\n5. [Test the API](#test_api)\n\n6. [Publish API](#publish_api)\n   1. [Create Customer Product and Add API](#customer_product)\n7. [Summary](#summary)\n\n---\n\n## 1. Introduction <a name=\"introduction\"></a>\n\nIn this lab, we will get a chance to use the IBM API Connect (APIC) Developer Toolkit and its intuitive interface to create a new API using the OpenAPI definition (YAML) of an existing Customer Database RESTful web service.\n\nIn this tutorial, we will explore the following key capabilities:\n\n-   Creating an API by importing an OpenAPI definition for an existing REST service\n\n-   Configuring ClientID/Secret Security, endpoints, and proxy to invoke an endpoint\n\n-   Testing a REST API in the developer toolkit\n\n-   Publish an API for developers\n\n## 2. Preparation step: Deploying the REST Services <a name=\"deploy\"></a>\n\nBefore we can use API Connect we must publish an API to expose. We will deploy a Customer Database REST service and then we will download the OpenAPI file for the the Customer Database REST service that we deployed.\n\n1\\. In a browser, enter the URL for the Platform Navigator that is provided by your instructor.\n\n2\\. Select the **Enterprise LDAP**:\n\n![alt text][pic0]\n\n**Note:** You may get a warning message that your connection is not private.  If you get this message, you can add an exception.   Occasionally in Edge on Windows you get a blank screen instead of a warning. If this is the case we recommend that you try a a different browser.\n\nTo add an exception in the Chrome browser, click **Advanced** and then click **Proceed** to the URL.\n\n![alt text][pic1]\n\n![alt text][pic2]\n\nTo add an exception in the Firefox browser, click **Advanced** and then click **Accept the Risk and Continue**.\n\n![alt text][pic3]\n\n![alt text][pic4]\n\n3\\. When prompted, use the username and password provided to you for this lab. The username in the screenshots of this lab is chopper12.\n\n![alt text][pic5]\n\n4\\. When you log in for the first time, you may see a **Welcome, let's get started** window.  Feel free to review the contents by click **Start the tour** or by click on the **X** to close the window.\n\n![alt text][pic91]\n\n5\\. Navigate to the **App Connect Dashboard**.\n\n![alt text][pic92]\n\n6\\. Click on the **Dashboard** icon in the left navigation.\n\n![alt text][pic93]\n\n7\\. If you would like to create this web service yourself, follow the instructions in the **Using a REST API to manage a set of records** tutorial (https://www.ibm.com/docs/en/app-connect/11.0.0?topic=enterprise-toolkit-tutorials-github).  Otherwise, you can download the **CustomerDatabaseV1.bar** file for the service [here](./resources/CustomerDatabaseV1.bar).\n\n8\\. Click on **Create server**.\n\n![alt text][pic94]\n\n9\\. Click **Quick start toolkit integration** and click **Next**.\n\n![alt text][pic95]\n\n10\\. Drag and drop the BAR file that you just downloaded or click to upload.  Click **Next**.\n\n![alt text][pic96]\n\n11\\. Click **Next**.\n\n![alt text][pic97]\n\n12\\. Give the Integration Server a **Name** (e.g. <span style=\"color: red\">username</span>-customerdb) and click **Create**.\n\n![alt text][pic98]\n\n13\\. This will take you back to the Servers Dashboard where you will see your new server. It will likely be showing Pending while it is starting up the pod.\n\n![alt text][pic99]\n\n14\\. Note: It may take a couple of minutes to start up. You can refresh the page. Once it is up and running it will show the following:\n\n![alt text][pic100]\n\n15\\.  Click on the newly created Integration Server.\n\n![alt text][pic101]\n\n16\\. Click on the **CustomerDatabaseV1** API.\n\n![alt text][pic102]\n\n17\\. Confirm that the **Overview** tab is selected and click **Download OpenAPI Document**.\n\n![alt text][pic103]\n\n[pic0]: images/0.png\n[pic1]: images/1.png\n[pic2]: images/2.png\n[pic3]: images/3.png\n[pic4]: images/4.png\n[pic5]: images/5.png\n[pic91]: images/91.png\n[pic92]: images/92.png\n[pic93]: images/93.png\n[pic94]: images/94.png\n[pic95]: images/95.png\n[pic96]: images/96.png\n[pic97]: images/97.png\n[pic98]: images/98.png\n[pic99]: images/99.png\n[pic100]: images/100.png\n[pic101]: images/101.png\n[pic102]: images/102.png\n[pic103]: images/103.png\n\n## 3. Import an API into API Connect <a name=\"import_api\"></a>\n\n1\\. Click on **IBM Automation** in the upper left.\n\n![alt text][pic104]\n\n2\\. Navigate to the API Connect instance.\n\n![alt text][pic6]\n\n3\\. Click **TechCon LDAP User Registry**. *If you are not following this guide as part of a TechJam log in with your standard credentials and jump to 6.*\n\n![alt text][pic7]\n\n4\\. When prompted, log in with the username and password provided to you for this lab. Click **Log in**. The username in the screenshots of this lab is chopper12.\n\n**Note:** If you get a warning message that your connection is not private, follow the instructions in the previous section.\n\n![alt text][pic8]\n\n5\\. When you log in for the first time, you may see a **Get started** window.  Feel free to review the contents and close the window.\n\n6\\. Confirm that you are in the provider organization for your username (upper right) and then click on **Develop APIs and products**.\n\n![alt text][pic9]\n\n7\\. We are now able to begin to create APIs and Products.  Click **Add**.\n\n![alt text][pic10]\n\n8\\. Click **API (from REST, GraphQL or SOAP)**.\n\n![alt text][pic11]\n\n9\\. Click **Existing OpenAPI** under **Import** and click **Next**.\n\n![alt text][pic12]\n\n10\\.  Select the **Customer_Database-1.0.0.yaml** file that was just downloaded and click **Next**.\n\n![alt text][pic13]\n\n11\\. Make sure that the **Activate API** <span style=\"color: red\">is not</span> selected and click **Next**. \n\n![alt text][pic14]\n\n12\\.  The API should be imported successfully as shown in the image below.  Click **Edit API**.\n\n![alt text][pic15]\n\n[pic6]: images/6.png\n[pic7]: images/7.png\n[pic8]: images/8.png\n[pic9]: images/9.png\n[pic10]: images/10.png\n[pic11]: images/11.png\n[pic12]: images/12.png\n[pic13]: images/13.png\n[pic14]: images/14.png\n[pic15]: images/15.png\n[pic104]: images/104.png\n\n## 4. Configure the API <a name=\"configure_api\"></a>\n\nAfter importing the existing API, the first step is to configure basic security before exposing it to other developers. By creating a client key and secret security, we are able to identify the application using the API.\n\nNext, we will define the backend endpoints where the API is actually running. IBM API Connect supports pointing to multiple backend endpoints to match your multiple build stage environments.\n\nFinally, we will configure the proxy call to invoke the endpoint.\n\n### 4a. Configure API Key Security <a name=\"configure_security\"></a>\n\n1\\. Upon import, you will notice that an error has been detected.  Click on the **error**.\n\n![alt text][pic16]\n\n2\\. The error indicates that **the openapi definition must contain the 'https' scheme.**.  After reviewing the error, click on the **X** to close the window.\n\n![alt text][pic17]\n\n3\\. To resolve the error, make sure that the **Design** tab is selected and click on the **+** next to **Schemes List**.\n\n![alt text][pic18]\n\n4\\. From the **Select an option** drop-down menu, select **https**.  Click **Create**.\n\n![alt text][pic19]\n\n![alt text][pic20]\n\n5\\. Expand the **Schemes List** section.  Under the Schemes List, **http** and **https** are listed.  Click **Save**.\n\n![alt text][pic21]\n\nOnce saved, you will see an indicator window appear that shows that **Your API has been updated**.  Click on the **X** to close the window.  You should no longer see the warning indicator.\n\n![alt text][pic22]\n\n6\\. Make sure that the **Design** tab is selected and click on the **+** next to **Security Schemes**.\n\n![alt text][pic23]\n\n7\\. For the **Security Definition Name (Key)**, enter a name (e.g., **X-IBM-Client-Id**) and select **apiKey** in the drop-down menu for **Security Definition Type**.\n\n![alt text][pic24]\n\n8\\. For the **Name**, enter a name (e.g., **X-IBM-Client-Id**), select **client_id** from the drop-down menu for **Key Type (optional)**, and select **header** from the drop-down menu for **Located In**.  Click **Create**.\n\n![alt text][pic25]\n\n9\\. Click **Save**.\n\n![alt text][pic26]\n\n10\\. Once saved, you will see an indicator window appear that shows that **Your API has been updated**.  Click on the **X** to close the window.\n\n![alt text][pic22]\n\n11\\. Make sure that the **Design** tab is selected and click on the **+** next to **Security Schemes**.\n\n![alt text][pic31]\n\n12\\. For the **Security Definition Name (Key)**, enter a name (e.g., **X-IBM-Client-Secret**) and select **apiKey** in the drop-down menu for **Security Definition Type**.\n\n![alt text][pic32]\n\n13\\. For the **Name**, enter a name (e.g., **X-IBM-Client-Secret**), select **client_secret** from the drop-down menu for **Key Type (optional)**, and select **header** from the drop-down menu for **Located In**.  Click **Create**.\n\n![alt text][pic33]\n\n14\\. Click **Save**.\n\n![alt text][pic26]\n\n15\\. Once saved, you will see an indicator window appear that shows that **Your API has been updated**.  Click on the **X** to close the window.\n\n![alt text][pic22]\n\n16\\. Make sure that the **Design** tab is selected and click on the **+** next to **Security**.\n\n![alt text][pic34]\n\n17\\. Select **\"X-IBM-Client-Id\"** and **\"X-IBM-Client-Secret\"** and click **Create**.\n\n![alt text][pic35]\n\n18\\. Click **Submit**.\n\n![alt text][pic37]\n\n19\\. Click **Save**.\n\n![alt text][pic26]\n\n20\\. Once saved, you will see an indicator window appear that shows that **Your API has been updated**.  Click on the **X** to close the window.\n\n![alt text][pic22]\n\n### 4b. Define a Target-URL for Sandbox Environment <a name=\"target_url\"></a>\n\n1\\. Make sure that the **Design** tab is selected and click on **Host**.\n\n![alt text][pic38]\n\n2\\. Copy the value in the **Host (optional)** field.\n\n![alt text][pic39]\n\n3\\. Navigate to the **Gateway** tab.\n\n![alt text][pic40]\n\n4\\. Make sure that the **Gateway** tab is selected and expand **Properties**.  Click on **target-url**.\n\n![alt text][pic41]\n\n5\\. Replace the **Property Value (optional)** with the value that you copied in Step 2.  **Note:**  Make sure to include a **http://** at the beginning and remove the **:** and **port number** (e.g. **:80**) from the end.\n\n![alt text][pic42]\n\n6\\. Click **Update**.\n\n![alt text][pic43]\n\n7\\. Click **Save**.\n\n![alt text][pic44]\n\n8\\. Navigate to the **Design** tab.\n\n![alt text][pic45]\n\n9\\. Click on **Host**.\n\n![alt text][pic46]\n\n10\\. Delete the value in the **Host (optional)** field.\n\n![alt text][pic47]\n\n11\\. Click **Save**.\n\n![alt text][pic26]\n\n12\\. Once saved, you will see an indicator window appear that shows that **Your API has been updated**.  Click on the **X** to close the window.\n\n![alt text][pic22]\n\n### 4c. Configure Proxy Call in Designer <a name=\"proxy\"></a>\n\n1\\. Navigate to the **Gateway** tab.\n\n![alt text][pic48]\n\n2\\. Make sure the **Gateway** tab is selected and click on **Policies**.\n\n![alt text][pic49]\n\n3\\. Click on the **Invoke** task in the assembly panel.\n\n![alt text][pic50]\n\n4\\. Update the **URL** so that it reads **$(target-url)$(request.path)**.\n\n![alt text][pic51]\n\n5\\. Click **Save**.\n\n![alt text][pic52]\n\n6\\. Once saved, you will see an indicator window appear that shows that **Your API has been updated**.  Click on the **X** to close the window.\n\n![alt text][pic53]\n\n[pic16]: images/16.png\n[pic17]: images/17.png\n[pic18]: images/18.png\n[pic19]: images/19.png\n[pic20]: images/20.png\n[pic21]: images/21.png\n[pic22]: images/22.png\n[pic23]: images/23.png\n[pic24]: images/24.png\n[pic25]: images/25.png\n[pic26]: images/26.png\n[pic27]: images/27.png\n[pic28]: images/28.png\n[pic29]: images/29.png\n[pic30]: images/30.png\n[pic31]: images/31.png\n[pic32]: images/32.png\n[pic33]: images/33.png\n[pic34]: images/34.png\n[pic35]: images/35.png\n[pic36]: images/36.png\n[pic37]: images/37.png\n[pic38]: images/38.png\n[pic39]: images/39.png\n[pic40]: images/40.png\n[pic41]: images/41.png\n[pic42]: images/42.png\n[pic43]: images/43.png\n[pic44]: images/44.png\n[pic45]: images/45.png\n[pic46]: images/46.png\n[pic47]: images/47.png\n[pic48]: images/48.png\n[pic49]: images/49.png\n[pic50]: images/50.png\n[pic51]: images/51.png\n[pic52]: images/52.png\n[pic53]: images/53.png\n\n## 5. Test the API <a name=\"test_api\"></a>\n\nIn the API Designer, you have the ability to test the API immediately after creation in the Assemble view!\n\n1\\. Switch the toggle from Offline to Online. This step automatically publishes the API.\n\n![alt text][pic54]\n\n2\\. You will see an indicator window appear that shows that **Your API has been updated**.  Click on the **X** to close the window.  You should see that the API is now Online.\n\n![alt text][pic55]\n\n3\\. Click on the **Test** tab.\n\n![alt text][pic56]\n\n4\\. For the **Request**, select the request that begins with **GET** and ends in **../customerdb/v1/customers**.  Click **Send**.\n\n![alt text][pic57]\n\n**Note:** If this is the first time testing the API after publishing it, you may get a **No response received** popup. Click **Here** and accept the certificate to see the 401 message.\n\n![alt text][pic58]\n\nTo add an exception in the Chrome browser, click in the whitespace of the page.\n\n![alt text][pic59]\n\nBlindly type **thisisunsafe**.  This should direct you to a new page that states **401 - Unauthorized**.\n\n![alt text][pic60]\n\nNavigate back to the **API Connect** browser window.\n\nTo add an exception in the Firefox browser, click **Advanced** and click **Accept the Risk and Continue**.\n\n![alt text][pic61]\n\n![alt text][pic62]\n\nThis will direct you to a new page that states **401 - Unauthorized**.\n\n![alt text][pic63]\n\nNavigate back to the **API Connect** browser window.\n\n5\\. Click **Send**.\n\n![alt text][pic57]\n\n6\\. The **Response** will show all of the customers in the database.\n\n![alt text][pic64]\n\n7\\. Now let's add a record to the database.  Click **Clear**.\n\n![alt text][pic65]\n\n8\\. For the **Request**, select the request that begins with **POST** and ends in **../customerdb/v1/customers**.  Click on the **Body** tab.\n\n ![alt text][pic66]\n\n9\\. In the **Body** tab, enter some text in the following JSON format:<br\\>\n```\n{  \n\"firstname\" : \"Emily\",  \n\"lastname\" : \"Drew\",  \n\"address\" : \"123 Colorado Address\"  \n}  \n```\n\nClick **Send**.\n\n![alt text][pic67]\n\n10\\. Make note of the **ID** number in the response.  In the example below, the ID is 9.\n\n![alt text][pic68]\n\n11\\. For the **Request**, select the request that begins with **GET** and ends in **../customerdb/v1/customers/{customerId}** and click **Clear**.\n\n![alt text][pic69]\n\n12\\. Click on the **Parameters** tab and enter the **ID** that you noted in step 10. Click **Send**.\n\n![alt text][pic70]\n\n13\\. In the response, you will see the customer information that you entered in step 9.\n\n![alt text][pic71]\n\n14\\. We can now update the customer information. For the **Request**, select the request that begins with **PUT** and ends in **../customerdb/v1/customers/{customerId}** and click **Clear**.\n\n![alt text][pic72]\n\n15\\. Enter the **ID** that you noted in step 10 and click on the **Body** tab.\n\n![alt text][pic73]\n\n16\\. In the **Body** tab, enter some text in the following JSON format:<br\\>\n```\n{\n  \"firstname\": \"Emily\",\n  \"lastname\": \"Drew\",\n  \"address\": \"123 Colorado Address\"\n}\n```\nand click **Send**.\n\n![alt text][pic74]\n\n17\\. The response should show that the customer ID was updated.\n\n![alt text][pic75]\n\n18\\. For the **Request**, select the request that begins with **GET** and ends in **../customerdb/v1/customers/{customerId}** and click **Clear**.\n\n![alt text][pic69]\n\n19\\. Make sure that the **Parameters** tab is selected and enter the **ID** that you noted in step 10. Click **Send**.\n\n![alt text][pic70]\n\n20\\. In the response, you will see the customer information that you entered in step 16.\n\n![alt text][pic76]\n\n21\\. You can also delete a customer from the customer database.  For the **Request**, select the request that begins with **DELETE** and ends in **../customerdb/v1/customers/{customerId}** and click **Clear**.\n\n![alt text][pic77]\n\n22\\. Make sure that the **Parameters** tab is selected and enter the **ID** that you noted in step 10 and enter **secr3t** for **Authorization**. Click **Send**.\n\n![alt text][pic78]\n\n23\\. In the response, you will see the customer was deleted.\n\n![alt text][pic79]\n\n[pic54]: images/54.png\n[pic55]: images/55.png\n[pic56]: images/56.png\n[pic57]: images/57.png\n[pic58]: images/58.png\n[pic59]: images/59.png\n[pic60]: images/60.png\n[pic61]: images/61.png\n[pic62]: images/62.png\n[pic63]: images/63.png\n[pic64]: images/64.png\n[pic65]: images/65.png\n[pic66]: images/66.png\n[pic67]: images/67.png\n[pic68]: images/68.png\n[pic69]: images/69.png\n[pic70]: images/70.png\n[pic71]: images/71.png\n[pic72]: images/72.png\n[pic73]: images/73.png\n[pic74]: images/74.png\n[pic75]: images/75.png\n[pic76]: images/76.png\n[pic77]: images/77.png\n[pic78]: images/78.png\n[pic79]: images/79.png\n\n## 6. Publish API <a name=\"publish_api\"></a>\n\nIn this lab, we will make the API available to developers. In order to do so, the API must be first put into a product and then published to the Sandbox catalog. A product dictates rate limits and API throttling.\n\nWhen the product is published, the Invoke policy defined in the previous lab is written to the gateway. \n\n### 6a. Create Customer Product and Add API <a name=\"customer_product\"></a>\n\n1\\. From the vertical navigation menu on the left, click **Develop**.\n\n![alt text][pic80]\n\n2\\. Click the **Products** tab.\n\n![alt text][pic82]\n\n3\\. Click **Add** and click **Product** from the drop-down menu.\n\n![alt text][pic83]\n\n![alt text][pic84]\n\n4\\. Click **New product** and click **Next**.\n\n![alt text][pic85]\n\n5\\. Enter **Customer** for the **Title** and click **Next**.\n\n![alt text][pic86]\n\n6\\. Select the **Customer Database** API and click **Next**.\n\n![alt text][pic87]\n\n7\\. Keep the **Default Plan** as is and click **Next**.\n\n![alt text][pic88]\n\n8\\. Select **Publish product** and confirm that **Visibility** is set to **Public** and **Subscribability** is set to **Authenticated**.  Click **Next**.\n\n![alt text][pic89]\n\n9\\.  The Product is now published successfully with the API base URL listed and available for developers from the Developer Portal.  Click **Done**.\n\n![alt text][pic90]\n\n[pic80]: images/80.png\n[pic81]: images/81.png\n[pic82]: images/82.png\n[pic83]: images/83.png\n[pic84]: images/84.png\n[pic85]: images/85.png\n[pic86]: images/86.png\n[pic87]: images/87.png\n[pic88]: images/88.png\n[pic89]: images/89.png\n[pic90]: images/90.png\n\n## 7.Summary <a name=\"summary\"></a>\n\nCongratulations, you have completed the **Create and Secure an API** lab. Throughout the lab, you learned how to:\n\n-   Create an API by importing an OpenAPI definition for an existing REST service\n\n-   Configure ClientID/Secret Security, endpoints, and proxy to invoke endpoint\n\n-   Test a REST API in the Developer Toolkit\n\n-   Publish an API for developers\n\n### [Return to main APIC lab page](../../APIC-labs-new/Overview/)\n","type":"Mdx","contentDigest":"af7f9159c6ad57abbfaee16013cddc8d","owner":"gatsby-plugin-mdx","counter":1510},"frontmatter":{"title":"Create and Secure an API to Proxy an Existing REST Web Service"},"exports":{},"rawBody":"---\ntitle: Create and Secure an API to Proxy an Existing REST Web Service\n---\n\n### [Return to main APIC lab page](../../APIC-labs-new/Overview/)\n\n---\n\n# Table of Contents\n1. [Introduction](#introduction)\n2. [Deploying the REST Service](#deploy)\n\n3. [Import an API into the Developer Workspace](#import_api)\n\n4. [Configure the API ](#configure_api)  \n   1. [Configure API Key Security](#configure_security)  \n   2. [Define a Target-URL for Sandbox Environment](#target_url)  \n   3. [Configure Proxy Call in Designer](#proxy)  \n\n5. [Test the API](#test_api)\n\n6. [Publish API](#publish_api)\n   1. [Create Customer Product and Add API](#customer_product)\n7. [Summary](#summary)\n\n---\n\n## 1. Introduction <a name=\"introduction\"></a>\n\nIn this lab, we will get a chance to use the IBM API Connect (APIC) Developer Toolkit and its intuitive interface to create a new API using the OpenAPI definition (YAML) of an existing Customer Database RESTful web service.\n\nIn this tutorial, we will explore the following key capabilities:\n\n-   Creating an API by importing an OpenAPI definition for an existing REST service\n\n-   Configuring ClientID/Secret Security, endpoints, and proxy to invoke an endpoint\n\n-   Testing a REST API in the developer toolkit\n\n-   Publish an API for developers\n\n## 2. Preparation step: Deploying the REST Services <a name=\"deploy\"></a>\n\nBefore we can use API Connect we must publish an API to expose. We will deploy a Customer Database REST service and then we will download the OpenAPI file for the the Customer Database REST service that we deployed.\n\n1\\. In a browser, enter the URL for the Platform Navigator that is provided by your instructor.\n\n2\\. Select the **Enterprise LDAP**:\n\n![alt text][pic0]\n\n**Note:** You may get a warning message that your connection is not private.  If you get this message, you can add an exception.   Occasionally in Edge on Windows you get a blank screen instead of a warning. If this is the case we recommend that you try a a different browser.\n\nTo add an exception in the Chrome browser, click **Advanced** and then click **Proceed** to the URL.\n\n![alt text][pic1]\n\n![alt text][pic2]\n\nTo add an exception in the Firefox browser, click **Advanced** and then click **Accept the Risk and Continue**.\n\n![alt text][pic3]\n\n![alt text][pic4]\n\n3\\. When prompted, use the username and password provided to you for this lab. The username in the screenshots of this lab is chopper12.\n\n![alt text][pic5]\n\n4\\. When you log in for the first time, you may see a **Welcome, let's get started** window.  Feel free to review the contents by click **Start the tour** or by click on the **X** to close the window.\n\n![alt text][pic91]\n\n5\\. Navigate to the **App Connect Dashboard**.\n\n![alt text][pic92]\n\n6\\. Click on the **Dashboard** icon in the left navigation.\n\n![alt text][pic93]\n\n7\\. If you would like to create this web service yourself, follow the instructions in the **Using a REST API to manage a set of records** tutorial (https://www.ibm.com/docs/en/app-connect/11.0.0?topic=enterprise-toolkit-tutorials-github).  Otherwise, you can download the **CustomerDatabaseV1.bar** file for the service [here](./resources/CustomerDatabaseV1.bar).\n\n8\\. Click on **Create server**.\n\n![alt text][pic94]\n\n9\\. Click **Quick start toolkit integration** and click **Next**.\n\n![alt text][pic95]\n\n10\\. Drag and drop the BAR file that you just downloaded or click to upload.  Click **Next**.\n\n![alt text][pic96]\n\n11\\. Click **Next**.\n\n![alt text][pic97]\n\n12\\. Give the Integration Server a **Name** (e.g. <span style=\"color: red\">username</span>-customerdb) and click **Create**.\n\n![alt text][pic98]\n\n13\\. This will take you back to the Servers Dashboard where you will see your new server. It will likely be showing Pending while it is starting up the pod.\n\n![alt text][pic99]\n\n14\\. Note: It may take a couple of minutes to start up. You can refresh the page. Once it is up and running it will show the following:\n\n![alt text][pic100]\n\n15\\.  Click on the newly created Integration Server.\n\n![alt text][pic101]\n\n16\\. Click on the **CustomerDatabaseV1** API.\n\n![alt text][pic102]\n\n17\\. Confirm that the **Overview** tab is selected and click **Download OpenAPI Document**.\n\n![alt text][pic103]\n\n[pic0]: images/0.png\n[pic1]: images/1.png\n[pic2]: images/2.png\n[pic3]: images/3.png\n[pic4]: images/4.png\n[pic5]: images/5.png\n[pic91]: images/91.png\n[pic92]: images/92.png\n[pic93]: images/93.png\n[pic94]: images/94.png\n[pic95]: images/95.png\n[pic96]: images/96.png\n[pic97]: images/97.png\n[pic98]: images/98.png\n[pic99]: images/99.png\n[pic100]: images/100.png\n[pic101]: images/101.png\n[pic102]: images/102.png\n[pic103]: images/103.png\n\n## 3. Import an API into API Connect <a name=\"import_api\"></a>\n\n1\\. Click on **IBM Automation** in the upper left.\n\n![alt text][pic104]\n\n2\\. Navigate to the API Connect instance.\n\n![alt text][pic6]\n\n3\\. Click **TechCon LDAP User Registry**. *If you are not following this guide as part of a TechJam log in with your standard credentials and jump to 6.*\n\n![alt text][pic7]\n\n4\\. When prompted, log in with the username and password provided to you for this lab. Click **Log in**. The username in the screenshots of this lab is chopper12.\n\n**Note:** If you get a warning message that your connection is not private, follow the instructions in the previous section.\n\n![alt text][pic8]\n\n5\\. When you log in for the first time, you may see a **Get started** window.  Feel free to review the contents and close the window.\n\n6\\. Confirm that you are in the provider organization for your username (upper right) and then click on **Develop APIs and products**.\n\n![alt text][pic9]\n\n7\\. We are now able to begin to create APIs and Products.  Click **Add**.\n\n![alt text][pic10]\n\n8\\. Click **API (from REST, GraphQL or SOAP)**.\n\n![alt text][pic11]\n\n9\\. Click **Existing OpenAPI** under **Import** and click **Next**.\n\n![alt text][pic12]\n\n10\\.  Select the **Customer_Database-1.0.0.yaml** file that was just downloaded and click **Next**.\n\n![alt text][pic13]\n\n11\\. Make sure that the **Activate API** <span style=\"color: red\">is not</span> selected and click **Next**. \n\n![alt text][pic14]\n\n12\\.  The API should be imported successfully as shown in the image below.  Click **Edit API**.\n\n![alt text][pic15]\n\n[pic6]: images/6.png\n[pic7]: images/7.png\n[pic8]: images/8.png\n[pic9]: images/9.png\n[pic10]: images/10.png\n[pic11]: images/11.png\n[pic12]: images/12.png\n[pic13]: images/13.png\n[pic14]: images/14.png\n[pic15]: images/15.png\n[pic104]: images/104.png\n\n## 4. Configure the API <a name=\"configure_api\"></a>\n\nAfter importing the existing API, the first step is to configure basic security before exposing it to other developers. By creating a client key and secret security, we are able to identify the application using the API.\n\nNext, we will define the backend endpoints where the API is actually running. IBM API Connect supports pointing to multiple backend endpoints to match your multiple build stage environments.\n\nFinally, we will configure the proxy call to invoke the endpoint.\n\n### 4a. Configure API Key Security <a name=\"configure_security\"></a>\n\n1\\. Upon import, you will notice that an error has been detected.  Click on the **error**.\n\n![alt text][pic16]\n\n2\\. The error indicates that **the openapi definition must contain the 'https' scheme.**.  After reviewing the error, click on the **X** to close the window.\n\n![alt text][pic17]\n\n3\\. To resolve the error, make sure that the **Design** tab is selected and click on the **+** next to **Schemes List**.\n\n![alt text][pic18]\n\n4\\. From the **Select an option** drop-down menu, select **https**.  Click **Create**.\n\n![alt text][pic19]\n\n![alt text][pic20]\n\n5\\. Expand the **Schemes List** section.  Under the Schemes List, **http** and **https** are listed.  Click **Save**.\n\n![alt text][pic21]\n\nOnce saved, you will see an indicator window appear that shows that **Your API has been updated**.  Click on the **X** to close the window.  You should no longer see the warning indicator.\n\n![alt text][pic22]\n\n6\\. Make sure that the **Design** tab is selected and click on the **+** next to **Security Schemes**.\n\n![alt text][pic23]\n\n7\\. For the **Security Definition Name (Key)**, enter a name (e.g., **X-IBM-Client-Id**) and select **apiKey** in the drop-down menu for **Security Definition Type**.\n\n![alt text][pic24]\n\n8\\. For the **Name**, enter a name (e.g., **X-IBM-Client-Id**), select **client_id** from the drop-down menu for **Key Type (optional)**, and select **header** from the drop-down menu for **Located In**.  Click **Create**.\n\n![alt text][pic25]\n\n9\\. Click **Save**.\n\n![alt text][pic26]\n\n10\\. Once saved, you will see an indicator window appear that shows that **Your API has been updated**.  Click on the **X** to close the window.\n\n![alt text][pic22]\n\n11\\. Make sure that the **Design** tab is selected and click on the **+** next to **Security Schemes**.\n\n![alt text][pic31]\n\n12\\. For the **Security Definition Name (Key)**, enter a name (e.g., **X-IBM-Client-Secret**) and select **apiKey** in the drop-down menu for **Security Definition Type**.\n\n![alt text][pic32]\n\n13\\. For the **Name**, enter a name (e.g., **X-IBM-Client-Secret**), select **client_secret** from the drop-down menu for **Key Type (optional)**, and select **header** from the drop-down menu for **Located In**.  Click **Create**.\n\n![alt text][pic33]\n\n14\\. Click **Save**.\n\n![alt text][pic26]\n\n15\\. Once saved, you will see an indicator window appear that shows that **Your API has been updated**.  Click on the **X** to close the window.\n\n![alt text][pic22]\n\n16\\. Make sure that the **Design** tab is selected and click on the **+** next to **Security**.\n\n![alt text][pic34]\n\n17\\. Select **\"X-IBM-Client-Id\"** and **\"X-IBM-Client-Secret\"** and click **Create**.\n\n![alt text][pic35]\n\n18\\. Click **Submit**.\n\n![alt text][pic37]\n\n19\\. Click **Save**.\n\n![alt text][pic26]\n\n20\\. Once saved, you will see an indicator window appear that shows that **Your API has been updated**.  Click on the **X** to close the window.\n\n![alt text][pic22]\n\n### 4b. Define a Target-URL for Sandbox Environment <a name=\"target_url\"></a>\n\n1\\. Make sure that the **Design** tab is selected and click on **Host**.\n\n![alt text][pic38]\n\n2\\. Copy the value in the **Host (optional)** field.\n\n![alt text][pic39]\n\n3\\. Navigate to the **Gateway** tab.\n\n![alt text][pic40]\n\n4\\. Make sure that the **Gateway** tab is selected and expand **Properties**.  Click on **target-url**.\n\n![alt text][pic41]\n\n5\\. Replace the **Property Value (optional)** with the value that you copied in Step 2.  **Note:**  Make sure to include a **http://** at the beginning and remove the **:** and **port number** (e.g. **:80**) from the end.\n\n![alt text][pic42]\n\n6\\. Click **Update**.\n\n![alt text][pic43]\n\n7\\. Click **Save**.\n\n![alt text][pic44]\n\n8\\. Navigate to the **Design** tab.\n\n![alt text][pic45]\n\n9\\. Click on **Host**.\n\n![alt text][pic46]\n\n10\\. Delete the value in the **Host (optional)** field.\n\n![alt text][pic47]\n\n11\\. Click **Save**.\n\n![alt text][pic26]\n\n12\\. Once saved, you will see an indicator window appear that shows that **Your API has been updated**.  Click on the **X** to close the window.\n\n![alt text][pic22]\n\n### 4c. Configure Proxy Call in Designer <a name=\"proxy\"></a>\n\n1\\. Navigate to the **Gateway** tab.\n\n![alt text][pic48]\n\n2\\. Make sure the **Gateway** tab is selected and click on **Policies**.\n\n![alt text][pic49]\n\n3\\. Click on the **Invoke** task in the assembly panel.\n\n![alt text][pic50]\n\n4\\. Update the **URL** so that it reads **$(target-url)$(request.path)**.\n\n![alt text][pic51]\n\n5\\. Click **Save**.\n\n![alt text][pic52]\n\n6\\. Once saved, you will see an indicator window appear that shows that **Your API has been updated**.  Click on the **X** to close the window.\n\n![alt text][pic53]\n\n[pic16]: images/16.png\n[pic17]: images/17.png\n[pic18]: images/18.png\n[pic19]: images/19.png\n[pic20]: images/20.png\n[pic21]: images/21.png\n[pic22]: images/22.png\n[pic23]: images/23.png\n[pic24]: images/24.png\n[pic25]: images/25.png\n[pic26]: images/26.png\n[pic27]: images/27.png\n[pic28]: images/28.png\n[pic29]: images/29.png\n[pic30]: images/30.png\n[pic31]: images/31.png\n[pic32]: images/32.png\n[pic33]: images/33.png\n[pic34]: images/34.png\n[pic35]: images/35.png\n[pic36]: images/36.png\n[pic37]: images/37.png\n[pic38]: images/38.png\n[pic39]: images/39.png\n[pic40]: images/40.png\n[pic41]: images/41.png\n[pic42]: images/42.png\n[pic43]: images/43.png\n[pic44]: images/44.png\n[pic45]: images/45.png\n[pic46]: images/46.png\n[pic47]: images/47.png\n[pic48]: images/48.png\n[pic49]: images/49.png\n[pic50]: images/50.png\n[pic51]: images/51.png\n[pic52]: images/52.png\n[pic53]: images/53.png\n\n## 5. Test the API <a name=\"test_api\"></a>\n\nIn the API Designer, you have the ability to test the API immediately after creation in the Assemble view!\n\n1\\. Switch the toggle from Offline to Online. This step automatically publishes the API.\n\n![alt text][pic54]\n\n2\\. You will see an indicator window appear that shows that **Your API has been updated**.  Click on the **X** to close the window.  You should see that the API is now Online.\n\n![alt text][pic55]\n\n3\\. Click on the **Test** tab.\n\n![alt text][pic56]\n\n4\\. For the **Request**, select the request that begins with **GET** and ends in **../customerdb/v1/customers**.  Click **Send**.\n\n![alt text][pic57]\n\n**Note:** If this is the first time testing the API after publishing it, you may get a **No response received** popup. Click **Here** and accept the certificate to see the 401 message.\n\n![alt text][pic58]\n\nTo add an exception in the Chrome browser, click in the whitespace of the page.\n\n![alt text][pic59]\n\nBlindly type **thisisunsafe**.  This should direct you to a new page that states **401 - Unauthorized**.\n\n![alt text][pic60]\n\nNavigate back to the **API Connect** browser window.\n\nTo add an exception in the Firefox browser, click **Advanced** and click **Accept the Risk and Continue**.\n\n![alt text][pic61]\n\n![alt text][pic62]\n\nThis will direct you to a new page that states **401 - Unauthorized**.\n\n![alt text][pic63]\n\nNavigate back to the **API Connect** browser window.\n\n5\\. Click **Send**.\n\n![alt text][pic57]\n\n6\\. The **Response** will show all of the customers in the database.\n\n![alt text][pic64]\n\n7\\. Now let's add a record to the database.  Click **Clear**.\n\n![alt text][pic65]\n\n8\\. For the **Request**, select the request that begins with **POST** and ends in **../customerdb/v1/customers**.  Click on the **Body** tab.\n\n ![alt text][pic66]\n\n9\\. In the **Body** tab, enter some text in the following JSON format:<br\\>\n```\n{  \n\"firstname\" : \"Emily\",  \n\"lastname\" : \"Drew\",  \n\"address\" : \"123 Colorado Address\"  \n}  \n```\n\nClick **Send**.\n\n![alt text][pic67]\n\n10\\. Make note of the **ID** number in the response.  In the example below, the ID is 9.\n\n![alt text][pic68]\n\n11\\. For the **Request**, select the request that begins with **GET** and ends in **../customerdb/v1/customers/{customerId}** and click **Clear**.\n\n![alt text][pic69]\n\n12\\. Click on the **Parameters** tab and enter the **ID** that you noted in step 10. Click **Send**.\n\n![alt text][pic70]\n\n13\\. In the response, you will see the customer information that you entered in step 9.\n\n![alt text][pic71]\n\n14\\. We can now update the customer information. For the **Request**, select the request that begins with **PUT** and ends in **../customerdb/v1/customers/{customerId}** and click **Clear**.\n\n![alt text][pic72]\n\n15\\. Enter the **ID** that you noted in step 10 and click on the **Body** tab.\n\n![alt text][pic73]\n\n16\\. In the **Body** tab, enter some text in the following JSON format:<br\\>\n```\n{\n  \"firstname\": \"Emily\",\n  \"lastname\": \"Drew\",\n  \"address\": \"123 Colorado Address\"\n}\n```\nand click **Send**.\n\n![alt text][pic74]\n\n17\\. The response should show that the customer ID was updated.\n\n![alt text][pic75]\n\n18\\. For the **Request**, select the request that begins with **GET** and ends in **../customerdb/v1/customers/{customerId}** and click **Clear**.\n\n![alt text][pic69]\n\n19\\. Make sure that the **Parameters** tab is selected and enter the **ID** that you noted in step 10. Click **Send**.\n\n![alt text][pic70]\n\n20\\. In the response, you will see the customer information that you entered in step 16.\n\n![alt text][pic76]\n\n21\\. You can also delete a customer from the customer database.  For the **Request**, select the request that begins with **DELETE** and ends in **../customerdb/v1/customers/{customerId}** and click **Clear**.\n\n![alt text][pic77]\n\n22\\. Make sure that the **Parameters** tab is selected and enter the **ID** that you noted in step 10 and enter **secr3t** for **Authorization**. Click **Send**.\n\n![alt text][pic78]\n\n23\\. In the response, you will see the customer was deleted.\n\n![alt text][pic79]\n\n[pic54]: images/54.png\n[pic55]: images/55.png\n[pic56]: images/56.png\n[pic57]: images/57.png\n[pic58]: images/58.png\n[pic59]: images/59.png\n[pic60]: images/60.png\n[pic61]: images/61.png\n[pic62]: images/62.png\n[pic63]: images/63.png\n[pic64]: images/64.png\n[pic65]: images/65.png\n[pic66]: images/66.png\n[pic67]: images/67.png\n[pic68]: images/68.png\n[pic69]: images/69.png\n[pic70]: images/70.png\n[pic71]: images/71.png\n[pic72]: images/72.png\n[pic73]: images/73.png\n[pic74]: images/74.png\n[pic75]: images/75.png\n[pic76]: images/76.png\n[pic77]: images/77.png\n[pic78]: images/78.png\n[pic79]: images/79.png\n\n## 6. Publish API <a name=\"publish_api\"></a>\n\nIn this lab, we will make the API available to developers. In order to do so, the API must be first put into a product and then published to the Sandbox catalog. A product dictates rate limits and API throttling.\n\nWhen the product is published, the Invoke policy defined in the previous lab is written to the gateway. \n\n### 6a. Create Customer Product and Add API <a name=\"customer_product\"></a>\n\n1\\. From the vertical navigation menu on the left, click **Develop**.\n\n![alt text][pic80]\n\n2\\. Click the **Products** tab.\n\n![alt text][pic82]\n\n3\\. Click **Add** and click **Product** from the drop-down menu.\n\n![alt text][pic83]\n\n![alt text][pic84]\n\n4\\. Click **New product** and click **Next**.\n\n![alt text][pic85]\n\n5\\. Enter **Customer** for the **Title** and click **Next**.\n\n![alt text][pic86]\n\n6\\. Select the **Customer Database** API and click **Next**.\n\n![alt text][pic87]\n\n7\\. Keep the **Default Plan** as is and click **Next**.\n\n![alt text][pic88]\n\n8\\. Select **Publish product** and confirm that **Visibility** is set to **Public** and **Subscribability** is set to **Authenticated**.  Click **Next**.\n\n![alt text][pic89]\n\n9\\.  The Product is now published successfully with the API base URL listed and available for developers from the Developer Portal.  Click **Done**.\n\n![alt text][pic90]\n\n[pic80]: images/80.png\n[pic81]: images/81.png\n[pic82]: images/82.png\n[pic83]: images/83.png\n[pic84]: images/84.png\n[pic85]: images/85.png\n[pic86]: images/86.png\n[pic87]: images/87.png\n[pic88]: images/88.png\n[pic89]: images/89.png\n[pic90]: images/90.png\n\n## 7.Summary <a name=\"summary\"></a>\n\nCongratulations, you have completed the **Create and Secure an API** lab. Throughout the lab, you learned how to:\n\n-   Create an API by importing an OpenAPI definition for an existing REST service\n\n-   Configure ClientID/Secret Security, endpoints, and proxy to invoke endpoint\n\n-   Test a REST API in the Developer Toolkit\n\n-   Publish an API for developers\n\n### [Return to main APIC lab page](../../APIC-labs-new/Overview/)\n","fileAbsolutePath":"/Users/thomas/Documents/IBM/Projects/Internal/techjam/src/pages/apic/Lab1/index.md"}}},
    "staticQueryHashes": ["1364590287","137577622","2102389209","2456312558","2746626797","3018647132","3037994772","768070550"]}